---
title: "Homework 5"
author: "Fangyi Chen"
date: '`r format(Sys.time(), "%Y-%m-%d")`'
output: github_document
---


```{r load_libraries}
library(tidyverse)
library(ggridges)
library(rvest)

```



## Problem 2
```{r data loading & preprocessing}
file_names = list.files("data")

combined_df = map_df(file_names, ~{
  df = read_csv(file.path("data", .x), show_col_types = FALSE)
  
  subject_id = str_extract(.x, "\\d+")
  
  arm = str_extract(.x, "(con|exp)")
  
  df |> 
    mutate(subject_id = subject_id,
           arm = arm) |> 
    select(subject_id, arm, everything())
  
})

```


```{r spaghetti plot}

combined_df |> 
      pivot_longer(week_1:week_8,
                 names_to = "week",
                 names_prefix = "week_" ,
                 values_to = "observation") |> 
  ggplot(aes(x=week,y= observation, group=subject_id, color=arm)) +
  geom_line() + 
  facet_grid(. ~arm) +
  labs(title = "Spaghetti Plot of Observations Over Time",
       x = "Week",
       y = "Observation") 

```


